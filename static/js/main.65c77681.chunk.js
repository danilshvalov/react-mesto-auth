(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{31:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(1),i=a.n(s),c=a(23),r=a.n(c),o=(a(31),a(2)),l=a(13),u=a(3),d=a(16),m=a(17),b=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(d.a)(this,e),this._baseUrl=a,this._headers=n}return Object(m.a)(e,[{key:"sendRequest",value:function(e){var t=e.path,a=e.method,n=void 0===a?"GET":a,s=e.body,i=e.errorMessage;return fetch(new URL(t,this._baseUrl),{method:n,headers:this._headers,body:s}).then((function(e){return e.ok?e.json():Promise.reject("".concat(i,". \u041a\u043e\u0434 \u043e\u0448\u0438\u0431\u043a\u0438: ").concat(e.status))}))}},{key:"getInitialCards",value:function(){return this.sendRequest({path:"cards",errorMessage:"\u041f\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}},{key:"addPlace",value:function(e){var t=e.name,a=e.link;return this.sendRequest({path:"cards",method:"POST",body:JSON.stringify({name:t,link:a}),errorMessage:"\u041f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}},{key:"deleteCard",value:function(e){return this.sendRequest({path:"cards/".concat(e),method:"DELETE",errorMessage:"\u041f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}},{key:"setLike",value:function(e){return this.sendRequest({path:"cards/likes/".concat(e),method:"PUT",errorMessage:"\u041f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c like \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}},{key:"removeLike",value:function(e){return this.sendRequest({path:"cards/likes/".concat(e),method:"DELETE",errorMessage:"\u041f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u0443\u0431\u0440\u0430\u0442\u044c like \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.setLike(e):this.removeLike(e)}},{key:"getUserInfo",value:function(){return this.sendRequest({path:"users/me",errorMessage:"\u041f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}},{key:"setUserInfo",value:function(e){var t=e.name,a=e.about;return this.sendRequest({path:"users/me",method:"PATCH",body:JSON.stringify({name:t,about:a}),errorMessage:"\u041f\u0440\u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}},{key:"changeAvatar",value:function(e){return this.sendRequest({path:"users/me/avatar",method:"PATCH",body:JSON.stringify({avatar:e}),errorMessage:"\u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0430\u0432\u0430\u0442\u0430\u0440\u0430 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-19/",headers:{authorization:"68d238d8-54dd-4a8c-9a47-e308386a3ea7","Content-Type":"application/json; charset=utf-8"}}),j=i.a.createContext(),f=["abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","height","hidden","high","href","hrefLang","htmlFor","httpEquiv","icon","id","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","readOnly","rel","required","role","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","style","tabIndex","target","title","translate","type","typeMustMatch","useMap","value","width","wmode","wrap","onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"],h="form color-form",O="field__input color-form__input",p="fieldset color-form__fieldset",x="field color-form__field",v="color-form__title",_="submit-button color-form__submit-button",g={register:"register",registerContainer:"register__container",form:"form transparent-form register__form",fieldset:"fieldset transparent-form__fieldset",input:"field__input transparent-form__input register__input",field:"field transparent-form__field register__field",title:"transparent-form__title register__title",submitButton:"submit-button transparent-form__submit-button register__submit-button",subtextContainer:"transparent-form__subtext register__subtext-container",link:"transparent-form__link"},C={name:"email",type:"email",defaultValue:"",placeholder:"Email",required:!0},S={name:"password",type:"password",defaultValue:"",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0},N={titleText:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",submitButtonDefaultText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",submitButtonLoadingText:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u043c...",successMessage:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"},k={login:"login",loginContainer:"login__container",form:"form transparent-form login__form",fieldset:"fieldset transparent-form__fieldset",input:"field__input transparent-form__input login__input",field:"field transparent-form__field login__field",title:"transparent-form__title login__title",submitButton:"submit-button transparent-form__submit-button login__submit-button"},y={name:"email",type:"email",defaultValue:"",placeholder:"Email",required:!0},T={name:"password",type:"password",defaultValue:"",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0},L={titleText:"\u0412\u0445\u043e\u0434",submitButtonDefaultText:"\u0412\u043e\u0439\u0442\u0438",submitButtonLoadingText:"\u0412\u0445\u043e\u0434\u0438\u043c...",successMessage:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"},E={name:"add-element",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e"},I={defaultText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",loadingText:"\u0421\u043e\u0437\u0434\u0430\u0435\u043c..."},M={name:"title",type:"text",defaultValue:"",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0},w={name:"link",type:"url",defaultValue:"",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0},V="popup__add-element-fieldset",P={name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"},D={defaultText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",loadingText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."},q={name:"name",type:"text",placeholder:"\u0418\u043c\u044f",minLength:"2",maxLength:"40",required:!0},B={name:"job",type:"text",placeholder:"\u0414\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c",required:!0,minLength:"2",maxLength:"200"},U="popup__edit-profile-fieldset",R={name:"change-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"},A={defaultText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",loadingText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."},F={name:"avatar",type:"url",defaultValue:"",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0},z="popup__change-avatar-fieldset",J="info-tooltip",G="info-tooltip__icon",K="info-tooltip__text",H="picture popup__picture",W="picture__image",Q="picture__description",X="message",Y="message-box popup__message-box",Z="message-box__text",$={name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?"},ee={defaultText:"\u0414\u0430",loadingText:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."},te="header",ae="header__logo",ne="header__container",se="header__item",ie="navbar",ce="navbar__link",re="navbar__link navbar__link_type_dim",oe="navbar__item",le="navbar__container",ue="navbar__email",de="element",me="element__image",be="button delete-button element__delete-button",je="delete-button_hidden",fe="button like-button element__like-button",he="like-button_active",Oe="element__sidebar",pe="element__title",xe="element__like-container",ve="element__like-count",_e="popup",ge="popup_opened",Ce="popup__container",Se="button close-button popup__close-button",Ne="footer",ke="footer__copyright",ye="/sign-in",Te="/",Le="/sign-up",Ee="button theme-button",Ie="theme-switcher",Me=a(14),we=function(e){var t=Object.keys(e).filter((function(e){return f.some((function(t){return t===e}))})).map((function(t){return Object(Me.a)({},t,e[t])}));if(t.length>0)return Object.assign.apply(Object,Object(l.a)(t))},Ve=function(e){var t=e.theme,a=e.classList;if(a)return[].concat(Object(l.a)(a.split(" ").map((function(e){return"".concat(e," ").concat(e,"_theme_").concat(t)}))),["smooth-appearance"]).join(" ")};var Pe=function(){var e=i.a.useContext(j),t=Ve({theme:e,classList:Ne});return Object(n.jsx)("footer",{className:t,children:Object(n.jsx)("p",{className:ke,children:"\xa9 2020 \u2014 2021 Mesto Russia"})})},De=a.p+"static/media/header-logo.c2821b38.svg";var qe=function(e){var t=e.onThemeSwitch,a=i.a.useContext(j),s=Ve({theme:a,classList:Ee});return Object(n.jsx)("div",{className:Ie,children:Object(n.jsx)("button",{className:s,onClick:function(){t("dark"===a?"light":"dark")}})})},Be=a(4),Ue=a(9),Re=i.a.memo((function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:e.className});return Object(n.jsx)(Ue.b,Object(o.a)(Object(o.a)({to:e.to},we(e)),{},{className:a,children:e.children}))}));var Ae=function(e){return Object(n.jsx)("nav",{className:ie,children:Object(n.jsxs)("ul",{className:le,children:[Object(n.jsxs)(Be.b,{exact:!0,path:Te,children:[Object(n.jsx)("li",{className:oe,children:Object(n.jsx)("span",{className:ue,children:e.email})}),Object(n.jsx)("li",{className:oe,children:Object(n.jsx)(Re,{to:ye,className:re,onClick:e.onSignOut,children:"\u0412\u044b\u0439\u0442\u0438"})})]}),Object(n.jsx)(Be.b,{path:Le,children:Object(n.jsx)("li",{className:oe,children:Object(n.jsx)(Re,{to:ye,className:ce,children:"\u0412\u043e\u0439\u0442\u0438"})})}),Object(n.jsx)(Be.b,{path:ye,children:Object(n.jsx)("li",{className:oe,children:Object(n.jsx)(Re,{to:Le,className:ce,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})})]})})};var Fe=function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:te}),s=Ve({theme:t,classList:ae});return Object(n.jsxs)("header",{className:a,children:[Object(n.jsx)("img",{className:s,src:De,alt:"\u041c\u0435\u0441\u0442\u0430 \u0420\u043e\u0441\u0441\u0438\u0438"}),Object(n.jsxs)("div",{className:ne,children:[Object(n.jsx)("div",{className:se,children:Object(n.jsx)(qe,{onThemeSwitch:e.onThemeSwitch})}),Object(n.jsx)("div",{className:se,children:Object(n.jsx)(Ae,{email:e.email,onSignOut:e.onSignOut})})]})]})},ze=i.a.memo((function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:e.className});return Object(n.jsx)("button",Object(o.a)(Object(o.a)({},we(e)),{},{className:a,children:e.children}))}));var Je=function(e){var t=e.name,a=e.children,s=e.onClose,c=e.isOpen,r=i.a.useRef(),o=i.a.useRef();return i.a.useEffect((function(){c&&document.addEventListener("keydown",(function e(t){"Escape"===t.key&&(s(),document.removeEventListener("keydown",e))}))}),[c,s]),Object(n.jsx)("div",{className:"".concat(_e," ").concat(_e,"_type_").concat(t," ").concat(c?ge:""),ref:r,onClick:function(e){e.target!==r.current&&e.target!==o.current||s()},children:Object(n.jsxs)("div",{className:Ce,ref:o,children:[a,Object(n.jsx)(ze,{className:Se,onClick:s})]})})};var Ge=function(e){var t=e.name,a=e.link,s=e.isOpen,i=e.onClose;return Object(n.jsx)(Je,{name:t,isOpen:s,onClose:i,children:Object(n.jsxs)("div",{className:H,children:[Object(n.jsx)("img",{className:W,src:a,alt:t}),Object(n.jsx)("p",{className:Q,children:t})]})})},Ke=a.p+"static/media/avatar.c2fc30b5.svg",He=i.a.createContext(),We=a.p+"static/media/not-found.6c84ffca.svg";var Qe=function(e){var t=e.card,a=e.onCardClick,s=e.onCardLike,c=e.onCardDelete,r=i.a.useContext(He),o=i.a.useContext(j),l=t.owner._id===r._id,u=t.likes.some((function(e){return e._id===r._id})),d="".concat(Ve({theme:o,classList:be})," ").concat(l?"":je),m="".concat(Ve({theme:o,classList:fe})," ").concat(u?he:""),b=Ve({theme:o,classList:de}),f=Ve({theme:o,classList:ve});return Object(n.jsxs)("article",{className:b,children:[Object(n.jsx)("img",{className:me,src:t.link,alt:t.name,onClick:function(){a(t)},onError:function(e){t.link=We,e.target.src=We}}),Object(n.jsxs)("div",{className:Oe,children:[Object(n.jsx)("h3",{className:pe,children:t.name}),Object(n.jsxs)("div",{className:xe,children:[Object(n.jsx)(ze,{className:m,onClick:function(){s(t)}}),Object(n.jsx)("span",{className:f,children:t.likes.length})]}),Object(n.jsx)(ze,{className:d,onClick:function(){c(t)}})]})]})};var Xe=function(e){var t=e.cards,a=e.onEditAvatar,s=e.onAddPlace,c=e.onCardClick,r=e.onCardLike,o=e.onCardDelete,l=e.onEditProfile,u=i.a.useContext(He),d=i.a.useContext(j);return Object(n.jsxs)("main",{className:"content",children:[Object(n.jsxs)("section",{className:"profile",children:[Object(n.jsxs)("div",{className:"profile__image-container",children:[Object(n.jsx)("img",{className:"profile__avatar",src:u.avatar||Ke,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),Object(n.jsx)(ze,{className:"button profile__edit-avatar-button",onClick:a})]}),Object(n.jsxs)("div",{className:"profile__text",children:[Object(n.jsxs)("div",{className:"profile__name-container",children:[Object(n.jsx)("h1",{className:"profile__name",children:u.name}),Object(n.jsx)(ze,{className:"button edit-button profile__edit-button",onClick:l})]}),Object(n.jsx)("p",{className:"profile__about",children:u.about})]}),Object(n.jsx)(ze,{className:"button add-button profile__add-button",onClick:s})]}),Object(n.jsx)("section",{className:"elements elements_theme_".concat(d),children:t.map((function(e){return Object(n.jsx)(Qe,{card:e,onCardLike:r,onCardClick:c,onCardDelete:o},e._id)}))})]})};var Ye=function(e){var t=e.message,a=e.onClose,s=e.isOpen,c=i.a.useContext(j),r=Ve({theme:c,classList:Y});return Object(n.jsx)(Je,{name:X,onClose:a,isOpen:s,children:Object(n.jsx)("div",{className:r,children:Object(n.jsx)("span",{className:Z,children:t})})})};var Ze=function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:e.className});return Object(n.jsx)("form",Object(o.a)(Object(o.a)({},we(e)),{},{className:a,children:e.children}))},$e=i.a.memo((function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:e.className});return Object(n.jsx)("h2",Object(o.a)(Object(o.a)({},we(e)),{},{className:a,children:e.children}))}));var et=function(e){var t=e.name,a=e.title,s=e.children,i=e.onClose,c=e.isOpen,r=e.onSubmit,o=e.formClass,l=e.titleClass,u=e.submitButton;return Object(n.jsx)(Je,{name:t,isOpen:c,onClose:i,children:Object(n.jsxs)(Ze,{className:"".concat(_e,"__").concat(t,"-form ").concat(o),method:"POST",action:"/",name:t,noValidate:!0,onSubmit:r,children:[Object(n.jsx)($e,{className:l,children:a}),s,u]})})},tt=i.a.memo((function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:e.fieldClass}),s=Ve({theme:t,classList:e.inputClass}),c=i.a.useState(!1),r=Object(u.a)(c,2),l=r[0],d=r[1],m=i.a.useState(e.defaultValue),b=Object(u.a)(m,2),f=b[0],h=b[1],O=i.a.useState(""),p=Object(u.a)(O,2),x=p[0],v=p[1],_=i.a.useState(!1),g=Object(u.a)(_,2),C=g[0],S=g[1],N=i.a.useRef();i.a.useEffect((function(){e.isVisible&&(N.current.value=e.defaultValue,h(N.current.value),d(N.current.validity.valid),v(N.current.validationMessage),S(!1))}),[e.isVisible,e.defaultValue]),i.a.useEffect((function(){e.onInput({value:f,isValid:l})}),[f,l,e]);return Object(n.jsxs)("div",{className:a,children:[Object(n.jsx)("input",Object(o.a)(Object(o.a)({},we(e)),{},{className:s,id:"".concat(e.name,"-input"),name:"".concat(e.name,"Input"),onInput:function(e){var t=e.target;h(t.value),d(t.validity.valid),S(!t.validity.valid),v(t.validationMessage)},defaultValue:f,ref:N})),Object(n.jsx)("span",{className:"field__error-message ".concat(C?"field__error-message_visible":""),id:"".concat(e.name,"-input-error"),children:x})]})})),at=i.a.memo((function(e){var t=i.a.useContext(j),a="".concat(Ve({theme:t,classList:"".concat("submit-button button"," ").concat(e.className)})," ").concat(e.isEnabled||void 0===e.isEnabled?"":"submit-button_disabled");return Object(n.jsx)("button",Object(o.a)(Object(o.a)({},we(e)),{},{className:a,type:"submit",children:e.text}))}));var nt=function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:e.className});return Object(n.jsx)("div",Object(o.a)(Object(o.a)({},we(e)),{},{className:a,children:e.children}))};var st=function(e){var t=e.onClose,a=e.isOpen,s=e.onUpdateUser,c=D,r=c.defaultText,l=c.loadingText,d=i.a.useContext(He),m=i.a.useState({value:d.name,isValid:!1}),b=Object(u.a)(m,2),j=b[0],f=b[1],g=i.a.useState({value:d.about,isValid:!1}),C=Object(u.a)(g,2),S=C[0],N=C[1],k=i.a.useState(!1),y=Object(u.a)(k,2),T=y[0],L=y[1],E=i.a.useState(r),I=Object(u.a)(E,2),M=I[0],w=I[1];return i.a.useEffect((function(){L([j,S].every((function(e){return e.isValid})))}),[j,S]),Object(n.jsx)(et,Object(o.a)(Object(o.a)({},P),{},{onClose:t,isOpen:a,onSubmit:function(e){e.preventDefault(),T&&(w(l),s({name:j.value,about:S.value}).finally((function(){w(r)})))},formClass:h,titleClass:v,submitButton:Object(n.jsx)(at,Object(o.a)(Object(o.a)({},D),{},{className:_,isEnabled:T,text:M})),children:Object(n.jsxs)(nt,{className:"".concat(p," ").concat(U),children:[Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},q),{},{fieldClass:x,inputClass:O,onInput:f,isVisible:a,defaultValue:d.name?d.name:""})),Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},B),{},{fieldClass:x,inputClass:O,onInput:N,isVisible:a,defaultValue:d.about?d.about:""}))]})}))};var it=function(e){var t=e.onClose,a=e.isOpen,s=e.onAddPlace,c=I,r=c.defaultText,l=c.loadingText,d=i.a.useState({value:"",isValid:!1}),m=Object(u.a)(d,2),b=m[0],j=m[1],f=i.a.useState({value:"",isValid:!1}),g=Object(u.a)(f,2),C=g[0],S=g[1],N=i.a.useState(!1),k=Object(u.a)(N,2),y=k[0],T=k[1],L=i.a.useState(r),P=Object(u.a)(L,2),D=P[0],q=P[1];return i.a.useEffect((function(){T([b,C].every((function(e){return e.isValid})))}),[b,C]),Object(n.jsx)(et,Object(o.a)(Object(o.a)({},E),{},{onClose:t,isOpen:a,onSubmit:function(e){e.preventDefault(),y&&(q(l),s({name:b.value,link:C.value}).finally((function(){q(r)})))},formClass:h,titleClass:v,submitButton:Object(n.jsx)(at,Object(o.a)(Object(o.a)({},I),{},{className:_,isEnabled:y,text:D})),children:Object(n.jsxs)(nt,{className:"".concat(p," ").concat(V),children:[Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},M),{},{fieldClass:x,inputClass:O,onInput:j,isVisible:a})),Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},w),{},{fieldClass:x,inputClass:O,onInput:S,isVisible:a}))]})}))};var ct=function(e){var t=e.onClose,a=e.isOpen,s=e.onUpdateAvatar,c=A,r=c.defaultText,l=c.loadingText,d=i.a.useState({value:"",isValid:!1}),m=Object(u.a)(d,2),b=m[0],j=m[1],f=i.a.useState(!1),g=Object(u.a)(f,2),C=g[0],S=g[1],N=i.a.useState(r),k=Object(u.a)(N,2),y=k[0],T=k[1];return i.a.useEffect((function(){S(b.isValid)}),[b]),Object(n.jsx)(et,Object(o.a)(Object(o.a)({},R),{},{formClass:h,titleClass:v,onClose:t,isOpen:a,onSubmit:function(e){e.preventDefault(),C&&(T(l),s({avatar:b.value}).finally((function(){T(r)})))},submitButton:Object(n.jsx)(at,Object(o.a)(Object(o.a)({},A),{},{className:_,isEnabled:C,text:y})),children:Object(n.jsx)(nt,{className:"".concat(p," ").concat(z),children:Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},F),{},{fieldClass:x,inputClass:O,onInput:j,isVisible:a}))})}))};var rt=function(){var e=i.a.useContext(j),t=Ve({theme:e,classList:"loading-spinner"});return Object(n.jsx)("div",{className:t})};var ot=function(e){var t=e.onClose,a=e.isOpen,s=e.onCardDelete,c=e.card,r=ee,l=r.defaultText,d=r.loadingText,m=i.a.useState(l),b=Object(u.a)(m,2),j=b[0],f=b[1];return Object(n.jsx)(et,Object(o.a)(Object(o.a)({},$),{},{isOpen:a,onClose:t,onSubmit:function(e){e.preventDefault(),f(d),s(c).finally((function(){f(l)}))},formClass:h,titleClass:v,submitButton:Object(n.jsx)(at,{className:_,text:j})}))};var lt=function(e){var t=g,a=C,s=S,c=N,r=i.a.useState(!1),l=Object(u.a)(r,2),d=l[0],m=l[1],b=i.a.useState({value:"",isValid:!1}),j=Object(u.a)(b,2),f=j[0],h=j[1],O=i.a.useState({value:"",isValid:!1}),p=Object(u.a)(O,2),x=p[0],v=p[1],_=i.a.useState(c.submitButtonDefaultText),k=Object(u.a)(_,2),y=k[0],T=k[1];return i.a.useEffect((function(){m([f,x].every((function(e){return e.isValid})))}),[x,f]),Object(n.jsx)("section",{className:t.register,children:Object(n.jsxs)("div",{className:t.registerContainer,children:[Object(n.jsxs)(Ze,{className:t.form,onSubmit:function(t){t.preventDefault(),d&&(T(c.submitButtonLoadingText),e.onRegister({email:f.value,password:x.value}).finally((function(){T(c.submitButtonDefaultText)})))},children:[Object(n.jsx)($e,{className:t.title,children:c.titleText}),Object(n.jsxs)(nt,{className:t.fieldset,children:[Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},a),{},{onInput:h,inputClass:t.input,fieldClass:t.field})),Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},s),{},{onInput:v,inputClass:t.input,fieldClass:t.field}))]}),Object(n.jsx)(at,{className:t.submitButton,text:y,isEnabled:d})]}),Object(n.jsx)("div",{className:t.subtextContainer,children:Object(n.jsx)(Re,{className:t.link,to:ye,children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})})]})})},ut=a(25);var dt=function(e){var t=e.component,a=Object(ut.a)(e,["component"]);return Object(n.jsx)(Be.b,{children:function(){return a.loggedIn?Object(n.jsx)(t,Object(o.a)({},a)):Object(n.jsx)(Be.a,{to:ye})}})},mt=function(e){return e&&["dark","light"].some((function(t){return t===e}))},bt=function(e){mt(e)?localStorage.setItem("theme",e):localStorage.setItem("theme","dark")},jt=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(d.a)(this,e),this._baseUrl=a,this._headers=n}return Object(m.a)(e,[{key:"_errorIdentifier",value:function(e,t){return"".concat(t,". \u041a\u043e\u0434 \u043e\u0448\u0438\u0431\u043a\u0438: ").concat(e)}},{key:"sendRequest",value:function(e){var t=this,a=e.path,n=e.method,s=void 0===n?"GET":n,i=e.headers,c=e.body,r=e.errorMessage,l=e.errorIdentifier;return fetch(new URL(a,this._baseUrl),{method:s,headers:Object(o.a)(Object(o.a)({},this._headers),i),body:c}).then((function(e){return e.ok?e.json():l&&l(e.status)?Promise.reject(l(e.status)):Promise.reject(t._errorIdentifier(e.status,r))}))}},{key:"register",value:function(e){var t=e.email,a=e.password;return this.sendRequest({path:"signup",method:"POST",body:JSON.stringify({email:t,password:a}),errorMessage:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",errorIdentifier:function(e){if(400===e)return"\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"}})}},{key:"authorize",value:function(e){var t=e.email,a=e.password;return this.sendRequest({path:"signin",method:"POST",body:JSON.stringify({email:t,password:a}),errorMessage:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",errorIdentifier:function(e){return 400===e?"\u041d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u0431\u044b\u043b\u0438 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u044b":401===e?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 email \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c":void 0}})}},{key:"checkToken",value:function(e){return this.sendRequest({path:"users/me",method:"GET",headers:{Authorization:"Bearer ".concat(e)},errorMessage:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d",errorIdentifier:function(e){return 400===e?"\u0422\u043e\u043a\u0435\u043d \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043d\u0435 \u0431\u044b\u043b \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u0432 \u043d\u0435\u0432\u0435\u0440\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435":401===e?"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438":void 0}})}}]),e}())({baseUrl:"https://auth.nomoreparties.co/",headers:{"Content-Type":"application/json"}});var ft=function(e){var t=k,a=y,s=T,c=L,r=i.a.useState(!1),l=Object(u.a)(r,2),d=l[0],m=l[1],b=i.a.useState({value:"",isValid:!1}),j=Object(u.a)(b,2),f=j[0],h=j[1],O=i.a.useState({value:"",isValid:!1}),p=Object(u.a)(O,2),x=p[0],v=p[1],_=i.a.useState(c.submitButtonDefaultText),g=Object(u.a)(_,2),C=g[0],S=g[1];return i.a.useEffect((function(){m([f,x].every((function(e){return e.isValid})))}),[x,f]),Object(n.jsx)("section",{className:t.login,children:Object(n.jsx)("div",{className:t.loginContainer,children:Object(n.jsxs)(Ze,{className:t.form,onSubmit:function(t){t.preventDefault(),d&&(S(c.submitButtonLoadingText),e.onLogin({email:f.value,password:x.value}).finally((function(){S(c.submitButtonDefaultText)})))},children:[Object(n.jsx)($e,{className:t.title,children:c.titleText}),Object(n.jsxs)(nt,{className:t.fieldset,children:[Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},a),{},{onInput:h,inputClass:t.input,fieldClass:t.field})),Object(n.jsx)(tt,Object(o.a)(Object(o.a)({},s),{},{onInput:v,inputClass:t.input,fieldClass:t.field}))]}),Object(n.jsx)(at,{className:t.submitButton,text:C,isEnabled:d})]})})})},ht=a.p+"static/media/success.1b6082f8.svg",Ot=a.p+"static/media/failure.df8eddf6.svg";var pt=function(e){var t=i.a.useContext(j),a=Ve({theme:t,classList:J});return Object(n.jsx)(Je,{name:J,isOpen:e.isOpen,onClose:function(){e.onClose(e.redirectPath)},children:Object(n.jsxs)("div",{className:a,children:[e.isSuccess?Object(n.jsx)("img",{className:G,src:ht,alt:"\u0423\u0441\u043f\u0435\u0445"}):Object(n.jsx)("img",{className:G,src:Ot,alt:"\u041e\u0448\u0438\u0431\u043a\u0430"}),Object(n.jsx)("p",{className:K,children:e.message})]})})};var xt=function(){var e=i.a.useState(!0),t=Object(u.a)(e,2),a=t[0],s=t[1],c=i.a.useState(!0),r=Object(u.a)(c,2),d=r[0],m=r[1],f=i.a.useState(!0),h=Object(u.a)(f,2),O=h[0],p=h[1],x=i.a.useState(!1),v=Object(u.a)(x,2),_=v[0],g=v[1],C=i.a.useState(!1),S=Object(u.a)(C,2),k=S[0],y=S[1],T=i.a.useState(!1),E=Object(u.a)(T,2),I=E[0],M=E[1],w=i.a.useState(!1),V=Object(u.a)(w,2),P=V[0],D=V[1],q=i.a.useState(!1),B=Object(u.a)(q,2),U=B[0],R=B[1],A=i.a.useState(!1),F=Object(u.a)(A,2),z=F[0],J=F[1],G=i.a.useState(!1),K=Object(u.a)(G,2),H=K[0],W=K[1],Q=i.a.useState(),X=Object(u.a)(Q,2),Y=X[0],Z=X[1],$=i.a.useState(""),ee=Object(u.a)($,2),te=ee[0],ae=ee[1],ne=i.a.useState({message:"",redirectPath:""}),se=Object(u.a)(ne,2),ie=se[0],ce=se[1],re=i.a.useState(!1),oe=Object(u.a)(re,2),le=oe[0],ue=oe[1],de=i.a.useState({name:"",about:"",avatar:"",_id:""}),me=Object(u.a)(de,2),be=me[0],je=me[1],fe=i.a.useState(""),he=Object(u.a)(fe,2),Oe=he[0],pe=he[1],xe=i.a.useState(function(){var e=localStorage.getItem("theme");return mt(e)?e:(bt(),localStorage.getItem("theme"))}()),ve=Object(u.a)(xe,2),_e=ve[0],ge=ve[1],Ce=i.a.useState([]),Se=Object(u.a)(Ce,2),Ne=Se[0],ke=Se[1],Ee=i.a.useState(),Ie=Object(u.a)(Ee,2),Me=Ie[0],we=Ie[1],De=i.a.useState(!1),qe=Object(u.a)(De,2),Ue=qe[0],Re=qe[1],Ae=Object(Be.g)();document.addEventListener("DOMContentLoaded",(function(){m(!1)})),i.a.useEffect((function(){!function(){var e=localStorage.getItem("jwt");e?jt.checkToken(e).then((function(e){Re(!0),pe(e.data.email),We(Promise.all([b.getUserInfo(),b.getInitialCards()]),(function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];je(a),ke(n),p(!1)}))})).catch((function(){localStorage.removeItem("jwt"),Ae.push(ye),p(!1)})):(Re(!1),p(!1))}()}),[Ue,Ae]),i.a.useEffect((function(){s(O||d)}),[O,d]),i.a.useEffect((function(){bt(_e)}),[_e]);var ze=function(){M(!1),g(!1),y(!1),D(!1),J(!1)},Je=function(e){localStorage.setItem("jwt",e.token)},Ke=function(e){var t=e.message,a=e.redirectPath,n=e.isSuccess;ue(n),ce({message:t,redirectPath:a}),W(!0)},We=function(e,t){return e.then((function(e){return t(e)})).catch((function(e){e instanceof TypeError?ae("\u041f\u043e\u0442\u0435\u0440\u044f\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0434\u043d\u0435\u0435"):ae("string"===typeof e?e:"\u041d\u0435\u043f\u0440\u0435\u0434\u0432\u0438\u0434\u0435\u043d\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0434\u043d\u0435\u0435"),R(!0)}))};return Object(n.jsx)(He.Provider,{value:be,children:Object(n.jsx)(j.Provider,{value:_e,children:Object(n.jsxs)("div",{className:Ve({theme:_e,classList:"page"}),children:[Object(n.jsx)(Fe,{onThemeSwitch:function(){ge("dark"===_e?"light":"dark")},onSignOut:function(){localStorage.removeItem("jwt"),Re(!1),Ae.push(ye)},email:Oe}),a?Object(n.jsx)(rt,{}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(Be.d,{children:[Object(n.jsx)(dt,{exact:!0,path:"/",loggedIn:Ue,cards:Ne,onEditProfile:function(){g(!0)},onAddPlace:function(){y(!0)},onEditAvatar:function(){M(!0)},onCardClick:function(e){Z(e),J(!0)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===be._id}));We(b.changeLikeCardStatus(e._id,!t),(function(t){ke(Ne.map((function(a){return a._id===e._id?t:a})))}))},onCardDelete:function(e){we(e),D(!0)},component:Xe}),Object(n.jsx)(Be.b,{path:ye,children:Object(n.jsx)(ft,{onLogin:function(e){return jt.authorize(e).then((function(t){Je(t),Re(!0),pe(e.email),Ke({message:L.successMessage,redirectPath:Te,isSuccess:!0})})).catch((function(e){Ke({message:e,isSuccess:!1})}))}})}),Object(n.jsx)(Be.b,{path:Le,children:Object(n.jsx)(lt,{onRegister:function(e){return jt.register(e).then((function(e){Je(e),Ke({message:N.successMessage,redirectPath:ye,isSuccess:!0})})).catch((function(e){ue(!1),Ke({message:e,isSuccess:!1})}))}})}),Object(n.jsx)(Be.b,{path:"*",children:Ue?Object(n.jsx)(Be.a,{to:Te}):Object(n.jsx)(Be.a,{to:ye})})]}),Object(n.jsx)(Pe,{}),Object(n.jsx)(st,{isOpen:_,onClose:ze,onUpdateUser:function(e){return We(b.setUserInfo(e),(function(e){je(e),g(!1)}))}}),Object(n.jsx)(it,{isOpen:k,onClose:ze,onAddPlace:function(e){return We(b.addPlace(e),(function(e){ke([e].concat(Object(l.a)(Ne))),y(!1)}))}}),Object(n.jsx)(ct,{isOpen:I,onClose:ze,onUpdateAvatar:function(e){return We(b.changeAvatar(e.avatar),(function(e){var t=e.avatar;be.avatar=t,M(!1)}))}}),Object(n.jsx)(Ge,Object(o.a)(Object(o.a)({},Y),{},{isOpen:z,onClose:ze})),Object(n.jsx)(Ye,{isOpen:U,onClose:function(){R(!1)},message:te}),Object(n.jsx)(ot,{card:Me,onCardDelete:function(e){return We(b.deleteCard(e._id),(function(){ke(Ne.filter((function(t){return t._id!==e._id}))),D(!1)}))},isOpen:P,onClose:ze}),Object(n.jsx)(pt,{isOpen:H,onClose:function(e){W(!1),e&&Ae.push(e)},message:ie.message,redirectPath:ie.redirectPath,isSuccess:le})]})]})})})},vt=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,38)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),i(e),c(e)}))};r.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(Ue.a,{children:Object(n.jsx)(xt,{})})}),document.getElementById("root")),vt()}},[[37,1,2]]]);
//# sourceMappingURL=main.65c77681.chunk.js.map